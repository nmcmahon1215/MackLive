TeamManagerConsole=function(a){this.containerId=a;this.container=document.getElementById(a);this.teamPicker=document.getElementById("teamPicker");this.teamLogo=document.getElementById("teamLogo");this.teamName=document.getElementById("teamNameInput");this.teamAbbr=document.getElementById("teamAbbrInput");this.uploadButton=document.getElementById("uploadButton");this.saveButton=document.getElementById("saveButton");this.deleteButton=document.getElementById("deleteButton")};TeamManagerConsole.prototype={render:function(){$j(this.teamName).keyup(this.validateSave.bind(this));$j(this.teamAbbr).keyup(this.validateSave.bind(this));$j(this.teamAbbr).keypress(this.trimAbbr);$j(this.teamAbbr).change(this.trimAbbr);$j(this.uploadButton).on("change",this.previewImage.bind(this));$j(this.uploadButton).on("change",this.validateSave.bind(this));$j(this.saveButton).click(this.saveTeam.bind(this));$j(this.teamPicker).change(this.loadTeam.bind(this))},trimAbbr:function(a){if(this.value.length>=4){this.value=this.value.substr(0,3);return false}},validateSave:function(){if(this.teamName.value.length>0&&this.teamAbbr.value.length>0&&((this.uploadButton.files&&this.uploadButton.files[0])||this.teamId)){this.saveButton.disabled=false}else{this.saveButton.disabled=true}},previewImage:function(){if(this.uploadButton.files&&this.uploadButton.files[0]){var a=new FileReader();a.onload=function(b){$j(this.teamLogo).attr("src",b.target.result)}.bind(this);a.readAsDataURL(this.uploadButton.files[0])}},saveTeam:function(){var b=new XMLHttpRequest();var a=new FormData();if(this.teamId){a.append("teamId",this.teamId)}a.append("teamName",this.teamName.value.trim());a.append("teamAbbr",this.teamAbbr.value.trim());if(this.uploadButton.files&&this.uploadButton.files[0]){a.append("teamLogo",this.uploadButton.files[0])}b.addEventListener("load",function(){window.opener.location.reload();window.close()});b.addEventListener("error",function(){alert("Upload Failed!")});b.addEventListener("abort",function(){alert("Upload Canceled!")});b.open("POST","/api/teams");b.send(a)},loadTeam:function(){var a=this.teamPicker.selectedIndex;var b=this.teamPicker.children[a];var c=b.id;if(c&&c!=""){$j.ajax({url:location.protocol+"//"+location.host+"/api/teams/"+c,dataType:"json",context:this,success:function(d){this.teamId=c;this.teamName.value=d.name;this.teamAbbr.value=d.abbr;this.teamLogo.src=location.protocol+"//"+location.host+"/api/teams/image/"+c},error:function(){alert("Team loading failed.")}})}else{this.teamName.value="";this.teamAbbr.value="";this.teamLogo.src="/images/placeholderImage.png";this.teamId=null;this.uploadButton.value=null;this.validateSave()}}};